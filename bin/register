#!/usr/bin/env ruby

require 'nippo'
require 'optparse'

module Nippo
  def self.register_task(options)
    server = Nippo::Server.new('203.209.151.152', 'dooga', 'ldooga1')
    server.login('oyama-hiroyasu', '54q9JBBa')
    
    begin
      context = Nippo::Task.get_context
    rescue Exception => _
    end
  end
end

options = {}
OptionParser.new do |opt|
	opt.on('-d', '--day', 'the day to register') { |v| options[:task_day] = v }
	opt.on('-m', '--month', 'the month to register') { |v| options[:task_month] = v }
	opt.on('-y', '--year', 'the year to register') { |v| options[:task_year] = v }
	opt.on('-s', '--server', 'host address of Nippo service') { |v| options[:server] = v }
	opt.on('-U', '--basic_user', 'userid of BASIC authentication') { |v| options[:user] = v }
	opt.on('-P', '--basic_password', 'password to access Nippo service') { |v| options[:password] = v }
	opt.on('-u', '--login_user', 'userid of your-self to login') { |v| options[:user] = v }
	opt.on('-p', '--login_password', 'password which is related to your account') { |v| options[:password] = v }

	opt.parse! ARGV
end

Nippo.register_task(options)
